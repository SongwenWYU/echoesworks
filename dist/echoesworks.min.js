/*! echoesworks 10-06-2015 */
!function(a,b){"use strict";function c(a){return a.replace("github.com","rawgit.com")}var d=function(a){d.isObject(a)||(a={element:"slide",source:"data/data.json"}),this.options=a,this.source=this.options.source,this.element=this.options.element,this.playing=!1,this.totalTime=0;var b=this;this.fps=30,setInterval(function(){b.update()},1e3/this.fps),this.time=0,this.init()};d.prototype.init=function(){function a(a){return Math.max.apply(null,a)}function b(a){var b=document.createEvent("Event");b.initEvent(a,!0,!0),document.dispatchEvent(b)}var c=this;if(c.parser(),"object"==typeof c.parser.data.times){var d=c.parser.parseTime(c.parser.data.times);c.totalTime=a(d),b("ew:slide:init")}},d.prototype.stop=function(){this.playing=!1,this.time=0},d.prototype.pause=function(){this.playing=!1},d.prototype.play=function(){this.playing=!0},d.prototype.update=function(){this.playing&&(this.time+=1/this.fps),this.applyEchoes()},d.prototype.applyEchoes=function(){},d.VERSION="0.0.1",a.EchoesWorks=d,a.EW=d,d.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},d.isFunction=function(a){return"function"==typeof a||!1},d.defaults=function(a){if(!d.isObject(a))return a;for(var b=1,c=arguments.length;c>b;b++){var e=arguments[b];for(var f in e)void 0===a[f]&&(a[f]=e[f])}return a},d.extend=function(a){if(!d.isObject(a))return a;for(var b,c,e=1,f=arguments.length;f>e;e++){b=arguments[e];for(c in b)hasOwnProperty.call(b,c)&&(a[c]=b[c])}return a},d.get=function(a,b){d.send(a,"GET",b)},d.load=function(a,b){d.send(a,"GET",b)},d.post=function(a,b,c){d.send(a,"POST",c,b)},d.send=function(a,b,c,d){d=d||null;var e=new XMLHttpRequest;c instanceof Function&&(e.onreadystatechange=function(){4!==e.readyState||200!==e.status&&0!==e.status||c(e.responseText)}),e.open(b,a,!0),d instanceof Object&&(d=JSON.stringify(d),e.setRequestHeader("Content-Type","application/json")),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.send(d)};var e=function(){var a=this.options.element,b=1===a.nodeType?a:document.querySelector(a),c=[].filter.call(b.children,function(a){return"SCRIPT"!==a.nodeName}),d=c[0],e={},f=function(a,b){c[a]&&(d.className=d.className.replace(new RegExp("active(\\s|$)","g")," ").trim(),j("deactivate",k(d,b)),d=c[a],d.classList.add("active"),j("activate",k(d,b)))},g=function(a,b){return arguments.length?void(j("slide",k(c[a],b))&&f(a,b)):c.indexOf(d)},h=function(a,b){var e=c.indexOf(d)+a;j(a>0?"next":"prev",k(d,b))&&f(e,b)},i=function(a,b){return(e[a]||(e[a]=[])).push(b),function(){e[a]=e[a].filter(function(a){return a!==b})}},j=function(a,b){return(e[a]||[]).reduce(function(a,c){return a&&c(b)!==!1},!0)},k=function(a,b){return b=b||{},b.index=c.indexOf(a),b.slide=a,b},l={on:i,fire:j,slide:g,next:h.bind(null,1),prev:h.bind(null,-1),parent:b,slides:c};return f(0),l};d.prototype=d.extend(d.prototype,{slide:e});var f=function(){var a=this;f.init(a.source)};f.data=[],f.init=function(a){var b=new XMLHttpRequest;b.onreadystatechange=function(){4!==b.readyState||200!==b.status&&0!==b.status||f.parse(JSON.parse(b.responseText))},b.open("GET",a,!0),b.setRequestHeader("X-Requested-With","XMLHttpRequest"),b.send()},f.parse=function(a){function b(a){d.push(a.time),e.push(a.code),g.push(a.word)}var c,d=[],e=[],g=[];return a.forEach(b),c={times:d,codes:e,words:g},f.data=c,c},f.parseTime=function(a){var b=/\[\d{2}:\d{2}.\d{2}\]/g,c=[];return a.forEach(function(a){var d=a.slice(1,-1).split(":"),e=a.replace(b,"");c.push([60*parseFloat(d[0])+parseFloat(d[1]),e][0])}),c},d.prototype=d.extend(d.prototype,{parser:f});var g={regexobject:{headline:/^(\#{1,6})([^\#\n]+)$/m,code:/\s\`\`\`\n?([^`]+)\`\`\`/g,hr:/^(?:([\*\-_] ?)+)\1\1$/gm,lists:/^((\s*((\*|\-)|\d(\.|\))) [^\n]+)\n)+/gm,bolditalic:/(?:([\*_~]{1,3}))([^\*_~\n]+[^\*_~\s])\1/g,links:/!?\[([^\]<>]+)\]\(([^ \)<>]+)( "[^\(\)\"]+")?\)/g,reflinks:/\[([^\]]+)\]\[([^\]]+)\]/g,smlinks:/\@([a-z0-9]{3,})\@(t|gh|fb|gp|adn)/gi,mail:/<(([a-z0-9_\-\.])+\@([a-z0-9_\-\.])+\.([a-z]{2,7}))>/gim,tables:/\n(([^|\n]+ *\| *)+([^|\n]+\n))((:?\-+:?\|)+(:?\-+:?)*\n)((([^|\n]+ *\| *)+([^|\n]+)\n)+)/g,include:/[\[<]include (\S+) from (https?:\/\/[a-z0-9\.\-]+\.[a-z]{2,9}[a-z0-9\.\-\?\&\/]+)[\]>]/gi,url:/<([a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[\-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?)>/g},codeFilter:function(a,b){return b.replace(a[0],"<code>\n"+g.htmlEncode(a[1]).replace(/\n/gm,"<br/>").replace(/\ /gm,"&nbsp;")+"</code>\n")},headlinesFilter:function(a,b){var c=a[1].length;return b.replace(a[0],"<h"+c+">"+a[2]+"</h"+c+">\n")},linksFilter:function(a,b,c){return b="!"===a[0].substr(0,1)?b.replace(a[0],'<img src="'+a[2]+'" alt="'+a[1]+'" title="'+a[1]+'" />\n'):b.replace(a[0],"<a "+g.mmdCSSclass(a[2],c)+'href="'+a[2]+'">'+a[1]+"</a>\n")},mailFilter:function(a,b){return b.replace(a[0],'<a href="mailto:'+a[1]+'">'+a[1]+"</a>")},horizontalLineFilter:function(a,b){return b.replace(a[0],"\n<hr/>\n")},urlFilter:function(a,b,c){var d=a[1];return-1===d.indexOf("://")&&(d="http://"+d),b.replace(a[0],"<a "+g.mmdCSSclass(d,c)+'href="'+d+'">'+d.replace(/(https:\/\/|http:\/\/|mailto:|ftp:\/\/)/gim,"")+"</a>")},refLinksFilter:function(a,b,c,d){return a.replace(b[0],"<a "+g.mmdCSSclass(c[1],d)+'href="'+c[1]+'">'+b[1]+"</a>")},specialLinks:function(a,b,c){var d="";switch(a[2]){case"t":d="https://twitter.com/"+a[1];break;case"gh":d="https://github.com/"+a[1];break;case"fb":d="https://www.facebook.com/"+a[1];break;case"gp":d="https://plus.google.com/+"+a[1]}return b.replace(a[0],"<a "+g.mmdCSSclass(d,c)+'href="'+d+'">'+a[1]+"</a>")},boldItalicFilter:function(a,b){var c=[];if("~~"===a[1])b=b.replace(a[0],"<del>"+a[2]+"</del>");else{switch(a[1].length){case 1:c=["<i>","</i>"];break;case 2:c=["<b>","</b>"];break;case 3:c=["<i><b>","</b></i>"]}b=b.replace(a[0],c[0]+a[2]+c[1])}return b},tablesFilter:function(a,b,c){var d,e,f,g,h,i,j=0,k=0;for(d="<table><tr>",f=a[1].split("|"),g=a[4].split("|"),j=0;j<f.length;j++)g.length<=j?g.push(0):":"===g[j].trimRight().slice(-1)&&c!==!0?":"===g[j][0]?g[j]=3:g[j]=2:c!==!0&&":"===g[j][0]?g[j]=1:g[j]=0;for(e=["<th>",'<th align="left">','<th align="right">','<th align="center">'],j=0;j<f.length;j++)d+=e[g[j]]+f[j].trim()+"</th>";for(d+="</tr>",e=["<td>",'<td align="left">','<td align="right">','<td align="center">'],h=a[7].split("\n"),j=0;j<h.length;j++)if(i=h[j].split("|"),0!==i[0].length){for(;g.length<i.length;)g.push(0);for(d+="<tr>",k=0;k<i.length;k++)d+=e[g[k]]+i[k].trim()+"</td>";d+="</tr>\n"}return d+="</table>",b.replace(a[0],d)},listFilter:function(a,c){var d,e,f,g,h,i,j,k=0,l=0;for(j="*"===a[0].trim().substr(0,1)||"-"===a[0].trim().substr(0,1)?"<ul>":"<ol>",d=a[0].split("\n"),e=[],f=0,g=!1,k=0;k<d.length;k++)if(null!==(h=/^((\s*)((\*|\-)|\d(\.|\))) ([^\n]+))/.exec(d[k]))){for(h[2]===b||0===h[2].length?i=0:(g===!1&&(g=h[2].replace(/\t/,"    ").length),i=Math.round(h[2].replace(/\t/,"    ").length/g));f>i;)j+=e.pop(),f--,l--;for(;i>f;)"*"===h[0].trim().substr(0,1)||"-"===h[0].trim().substr(0,1)?(j+="<ul>",e.push("</ul>")):(j+="<ol>",e.push("</ol>")),f++,l++;j+="<li>"+h[6]+"</li>\n"}for(;l>0;)j+="</ul>",l--;return j+="*"===a[0].trim().substr(0,1)||"-"===a[0].trim().substr(0,1)?"</ul>":"</ol>",c.replace(a[0],j+"\n")},parse:function(a,b){var c,d,e,f,h=[];a="\n"+a+"\n";var i=g.regexobject;for(b!==!0&&(i.lists=/^((\s*(\*|\d\.) [^\n]+)\n)+/gm);null!==(e=i.code.exec(a));)a=this.codeFilter(e,a);for(;null!==(e=i.headline.exec(a));)a=this.headlinesFilter(e,a);for(;null!==(e=i.lists.exec(a));)a=this.listFilter(e,a);for(;null!==(e=i.tables.exec(a));)a=this.tablesFilter(e,a,b);for(f=0;3>f;f++)for(;null!==(e=i.bolditalic.exec(a));)a=this.boldItalicFilter(e,a);for(;null!==(e=i.links.exec(a));)a=this.linksFilter(e,a,b);for(;null!==(e=i.mail.exec(a));)a=this.mailFilter(e,a);for(;null!==(e=i.url.exec(a));)a=this.urlFilter(e,a,b);for(;null!==(e=i.reflinks.exec(a));)d=new RegExp("\\["+e[2]+"\\]: ?([^ \n]+)","gi"),null!==(c=d.exec(a))&&(a=this.refLinksFilter(a,e,c,b),h.push(c[0]));for(f=0;f<h.length;f++)a=a.replace(h[f],"");for(;null!==(e=i.smlinks.exec(a));)a=this.specialLinks(e,a,b);for(;null!==(e=i.hr.exec(a));)a=this.horizontalLineFilter(e,a);return a.replace(/ {2,}[\n]{1,}/gim,"<br/><br/>")},htmlEncode:function(a){var b=document.createElement("div");return b.appendChild(document.createTextNode(a)),b.innerHTML},mmdCSSclass:function(a,b){var c;return-1!==a.indexOf("/")&&b!==!0?(c=a.split("/"),c=0===c[1].length?c[2].split("."):c[0].split("."),'class="mmd_'+c[c.length-2].replace(/[^\w\d]/g,"")+c[c.length-1]+'" '):""}};d.md=g;var h={convertURL:c};d.prototype=d.extend(d.prototype,{fn:h})}(this),function(a){"use strict";var b,c,d=9,e=32,f=34,g=37,h=39,i=40,j=33,k=38;b=new EchoesWorks({element:"slide",source:"data/data.json"}),a.addEventListener("ew:slide:init",function(l){c=b.slide(),window.slide=c,a.addEventListener("keydown",function(a){var b=a.keyCode;(b===d||b>=e&&f>=b||b>=g&&i>=b)&&a.preventDefault()},!1),a.addEventListener("keyup",function(a){var b=a.keyCode;if(b===d||b>=e&&f>=b||b>=g&&i>=b){switch(b){case j:case g:case k:window.slide.prev();break;case d:case e:case f:case h:case i:window.slide.next()}a.preventDefault()}})})}(document);